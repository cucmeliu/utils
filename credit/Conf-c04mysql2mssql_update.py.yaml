# （基础信息）从mysql 复制到 ms sql数据库
# 日志
LOG:
    LOG_FORMAT: '%(asctime)s - %(levelname)s - %(message)s'
    DATE_FORMAT: '%m/%d/%Y %H:%M:%S %p'
    LOG_PATH: './'

GLOBAL: 
    # 是否先清空目标表
    IS_TRUNC_DEST: false

# src数据库
SRC_DB:
    HOST:   172.16.0.50
    USER:   root
    PWD:    mysql
    DB:     small_core
    # 地址
    # TABLE:  V_CREDIT_ADDRESS
    # SQL:    SELECT * FROM V_CREDIT_ADDRESS 
    # 职业
    # TABLE:  V_CREDIT_OCCUPATION
    # SQL:    SELECT * FROM V_CREDIT_OCCUPATION 
    # 身份
    # TABLE:  V_CREDIT_IDENTITY
    # SQL:    SELECT * FROM V_CREDIT_IDENTITY 
    # 基础
    TABLE:  t_his_credit
    SQL:    SELECT FINORGCODE, LOANTYPE, LOANBIZTYPE, BUSINESS_NO, AREACODE, STARTDATE, ENDDATE, CURRENCY, CREDIT_TOTAL_AMT, SHARE_CREDIT_TOTAL_AMT, MAX_DEBT_AMT, GUARANTEEFORM, PAYMENT_RATE, PAYMENT_MONTHS, NO_PAYMENT_MONTHS, PLAN_REPAY_DT, LAST_REPAY_DT, PLAN_REPAY_AMT, LAST_REPAY_AMT, BALANCE, CUR_OVERDUE_TOTAL_INT, CUR_OVERDUE_TOTAL_AMT, OVERDUE31_60DAYS_AMT, OVERDUE61_90DAYS_AMT, OVERDUE91_180DAYS_AMT, OVERDUE_180DAYS_AMT, SUM_OVERDUE_INT, MAX_OVERDUE_INT, CLASSIFY5, LOAN_STAT, REPAY_MONTH_24_STAT, OVERDRAFT_180DAYS_BAL, LOAN_ACCOUNT_STAT, CUSTNAME, CERTTYPE, CERTNO, CUSTID, BAKE, GMT_CREATE, 2 as bizType FROM t_his_credit  where GMT_CREATE > date_add(curdate(), INTERVAL 1 DAY) 
    # 特殊交易
    # TABLE:  V_CREDIT_SPEC_EVENT
    # SQL:    SELECT * FROM V_CREDIT_SPEC_EVENT 


# dest数据库
DEST_DB:
    HOST:   172.16.0.9
    USER:   test
    PWD:    test
    DB:     test_ccrs_source
    # 地址
    # TABLE:  V_P_CRS_ADRESS_INFO
    # SQL:    INSERT INTO V_P_CRS_ADRESS_INFO  VALUES (%s, %s, %s, %s, %s)
    # 职业
    # TABLE:  V_P_CRS_PROFESSION_INFO
    # SQL:    INSERT INTO V_P_CRS_PROFESSION_INFO  VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    # 身份
    # TABLE:  V_P_CRS_IDENTITY_INFO
    # SQL:    INSERT INTO V_P_CRS_IDENTITY_INFO  VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    # 基础
    TABLE:  V_P_CRS_LOAN_DTL
    # SQL:    UPDATE V_P_CRS_LOAN_DTL SET FINORGCODE=%s, LOANTYPE=%s, LOANBIZTYPE=%s, BUSINESS_NO=%s, AREACODE=%s, STARTDATE=%s, ENDDATE=%s, CURRENCY=%s, CREDIT_TOTAL_AMT=%s, SHARE_CREDIT_TOTAL_AMT=%s, MAX_DEBT_AMT=%s, GUARANTEEFORM=%s, PAYMENT_RATE=%s, PAYMENT_MONTHS=%s, NO_PAYMENT_MONTHS=%s, PLAN_REPAY_DT=%s, LAST_REPAY_DT=%s, PLAN_REPAY_AMT=%s, LAST_REPAY_AMT=%s, BALANCE=%s, CUR_OVERDUE_TOTAL_INT=%s, CUR_OVERDUE_TOTAL_AMT=%s, OVERDUE31_60DAYS_AMT=%s, OVERDUE61_90DAYS_AMT=%s, OVERDUE91_180DAYS_AMT=%s, OVERDUE_180DAYS_AMT=%s, SUM_OVERDUE_INT=%s, MAX_OVERDUE_INT=%s, CLASSIFY5=%s, LOAN_STAT=%s, REPAY_MONTH_24_STAT=%s, OVERDRAFT_180DAYS_BAL=%s, LOAN_ACCOUNT_STAT=%s, CUSTNAME=%s, CERTTYPE=%s, CERTNO=%s, CUSTID=%s, BAKE=%s, GMT_CREATE=%s, bizType=2 where BUSINESS_NO=%s and PLAN_REPAY_DT=%s;
    SQL:    UPDATE V_P_CRS_LOAN_DTL SET FINORGCODE=%s, LOANTYPE=%s, LOANBIZTYPE=%s, BUSINESS_NO=%s , AREACODE=%s, STARTDATE=%s, ENDDATE=%s where  BUSINESS_NO=%s and PLAN_REPAY_DT=%s  # , CURRENCY=%s, CREDIT_TOTAL_AMT=%s, SHARE_CREDIT_TOTAL_AMT=%s, MAX_DEBT_AMT=%s, GUARANTEEFORM=%s, PAYMENT_RATE=%s, PAYMENT_MONTHS=%s, NO_PAYMENT_MONTHS=%s, PLAN_REPAY_DT=%s, LAST_REPAY_DT=%s, PLAN_REPAY_AMT=%s, LAST_REPAY_AMT=%s, BALANCE=%s, CUR_OVERDUE_TOTAL_INT=%s, CUR_OVERDUE_TOTAL_AMT=%s, OVERDUE31_60DAYS_AMT=%s, OVERDUE61_90DAYS_AMT=%s, OVERDUE91_180DAYS_AMT=%s, OVERDUE_180DAYS_AMT=%s, SUM_OVERDUE_INT=%s, MAX_OVERDUE_INT=%s, CLASSIFY5=%s, LOAN_STAT=%s, REPAY_MONTH_24_STAT=%s, OVERDRAFT_180DAYS_BAL=%s, LOAN_ACCOUNT_STAT=%s, CUSTNAME=%s, CERTTYPE=%s, CERTNO=%s, CUSTID=%s, BAKE=%s, GMT_CREATE=%s, bizType=2 where BUSINESS_NO=%s and PLAN_REPAY_DT=%s;
    # 特殊交易
    # TABLE:  V_P_CRS_ADRESS_INFO
    # SQL:    INSERT INTO V_P_CRS_ADRESS_INFO  VALUES (%s, %s, %s, %s, %s)
